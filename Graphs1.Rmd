---
title: ""
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(maps)
library(tidyverse)
library(readxl)
library(plotly)
library(ggplot2)
library(reshape2)
library(dplyr)
```

```{r echo=FALSE, results='hide',message=FALSE}
############TYPE vs South/West Regions############
hc3_8 <- read_excel("./MyData/hc3.8.xlsx")
data1 = hc3_8
save( data1, file = "./MyData/data1.Rdata" )
data1

hc3_7 <- read_excel("./MyData/hc3.7.xlsx")
data2 = hc3_7
save(data2, file = "./MyData/data2.Rdata" )
data2

hc3_5 <- read_excel("./MyData/hc3.5.xlsx")
data3 = hc3_5
save(data3, file = "./MyData/data3.Rdata" )
data3

hc3_4 <- read_excel("./MyData/hc3.4.xlsx")
data4 = hc3_4
save(data4, file = "./MyData/data4.Rdata" )
data4

hc3_6 <- read_excel("./MyData/hc3.6.xlsx")
data5 = hc3_6
save(data5, file = "./MyData/data5.Rdata")
data5
```

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
####break the data into subsets####
fridgeSizeSW = data1[110:115 ,]
fridgeSizeNM = data2[107:112 ,]

fridgeTypeSW = data1[117:123 ,]
fridgeTypeNM = data2[114:120 ,]

incomeS = data3[107:112,]
incomeT = data3[114:120,]

membersS = data4[107:112,]
membersT = data4[114:120,]

climateS = data5[108:112,]
climateT =data5[115:120,]

```

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
####Init col names####
colnames(fridgeSizeSW) = c("Size", "Total","TotalSouth","South Atlantic","East South Central", "West South Central","Total West","Total Mountain", "Mountain North", "Mountain South", "Pacific")
colnames(fridgeSizeNM) = c("Size", "Total","Total Northeast","New England","Middle Atlantic", "Total Midwest","East North Central","West North Central")

colnames(fridgeTypeSW) = c("Type", "Total","TotalSouth","South Atlantic","East South Central", "West South Central","Total West","Total Mountain", "Mountain North", "Mountain South", "Pacific")
colnames(fridgeTypeNM) = c("Type", "Total","Total Northeast","New England","Middle Atlantic", "Total Midwest","East North Central","West North Central")

colnames(incomeS) = c("Size", "Total", "under_20", "20_40","40_60", "60_80", "80_100", "100_120","120_140", "over_140")
colnames(incomeT) = c("Type", "Total", "under_20", "20_40","40_60", "60_80", "80_100", "100_120","120_140", "over_140")

colnames(membersS) = c("Size", "Total", "OneMember", "TwoMembers", "ThreeMembers", "FourMembers", "FiveMoreMembers")
colnames(membersT) = c("Type", "Total", "OneMember", "TwoMembers", "ThreeMembers", "FourMembers", "FiveMoreMembers")

colnames(climateS) = c("Size", "Total", "Cold", "Mixed-humid", "Hot-dry", "Hot-humid", "Marine")
colnames(climateT) = c("Type", "Total", "Cold", "Mixed-humid", "Hot-dry", "Hot-humid", "Marine")

####Dropping total col####
fridgeSizeSW2 <- within(fridgeSizeSW, rm(Total))
fridgeSizeNM2 <- within(fridgeSizeNM, rm(Total))

fridgeTypeSW2 <- within(fridgeTypeSW, rm(Total))
fridgeTypeNM2 <- within(fridgeTypeNM, rm(Total))

incomeS2  <- within(incomeS, rm(Total))
incomeT2  <- within(incomeT, rm(Total))

membersS2  <- within(membersS, rm(Total))
membersT2  <- within(membersT, rm(Total))

climateS2  <- within(climateS, rm(Total))
climateT2  <- within(climateT, rm(Total))

####Coerce fridge size/type col to factors/categorical####
fridgeSizeSW2$Size <- as.factor(fridgeSizeSW2$Size)
fridgeSizeNM2$Size <- as.factor(fridgeSizeNM2$Size)

fridgeTypeSW2$Type <- as.factor(fridgeTypeSW2$Type)
fridgeTypeNM2$Type <- as.factor(fridgeTypeNM2$Type)

incomeS2$Size  <- as.factor(incomeS2$Size)
incomeT2$Type  <- as.factor(incomeT2$Type)

membersS2$Size  <- as.factor(membersS2$Size)
membersT2$Type  <- as.factor(membersT2$Type)

climateS2$Size  <- as.factor(climateS2$Size)
climateT2$Type  <- as.factor(climateT2$Type)

####Coerce rest of cols to continous/numeric####
fridgeSizeSW2[, 2:10] <- sapply(fridgeSizeSW2[, 2:10], as.numeric)
fridgeSizeNM2[, 2:7] <- sapply(fridgeSizeNM2[, 2:7], as.numeric)

fridgeTypeSW2[, 2:10] <- sapply(fridgeTypeSW2[, 2:10], as.numeric)
fridgeTypeNM2[, 2:7] <- sapply(fridgeTypeNM2[, 2:7], as.numeric)

incomeS2[, 2:9]  <- sapply(incomeS2[, 2:9], as.numeric)
incomeT2[, 2:9]  <- sapply(incomeT2[, 2:9], as.numeric)

membersS2[, 2:6]  <- sapply(membersS2[, 2:6], as.numeric)
membersT2[, 2:6]  <- sapply(membersT2[, 2:6], as.numeric)

climateS2[, 2:6] <- sapply(climateS2[, 2:6], as.numeric)
climateT2[, 2:6] <- sapply(climateT2[, 2:6], as.numeric)

####Rename cols####
colnames(fridgeSizeSW2) <- c("Size","Total South","South Atlantic","East South Central", "West South Central","Total West","Total Mountain", "Mountain North", "Mountain South", "Pacific")
colnames(fridgeSizeNM2) <- c("Size","Total Northeast","New England","Middle Atlantic", "Total Midwest","East North Central","West NorthC entral")

colnames(fridgeTypeSW2) <- c("Type","Total South","South Atlantic","East South Central", "West South Central","Total West","Total Mountain", "Mountain North", "Mountain South", "Pacific")
colnames(fridgeTypeNM2) <- c("Type","Total Northeast","New England","Middle Atlantic", "Total Midwest","East North Central","West North Central")

colnames(incomeS2)  <- c("Size", "Under 20,000", "20,000-40,000","40,000-60,000", "60,000-80,000", "80,000-100,000", "100,000-120,000","120,000-140,000", "Over 140,000")
colnames(incomeT2)  <- c("Type", "Under 20,000", "20,000-40,000","40,000-60,000", "60,000-80,000", "80,000-100,000", "100,000-120,000","120,000-140,000", "Over 140,000")

colnames(membersS2) = c("Size", "One Member", "Two Members", "Three Members", "Four Members", "Five or More Members")
colnames(membersT2) = c("Type", "One Member", "Two Members", "Three Members", "Four Members", "Five or More Members")

colnames(climateS2) = c("Size", "Cold", "Mixed-humid", "Hot-dry", "Hot-humid", "Marine")
colnames(climateT2) = c("Type", "Cold", "Mixed-humid", "Hot-dry", "Hot-humid", "Marine")

####Coerce into tibble --> easier to work with####
fridgeSizeSW3<- as_tibble(melt(fridgeSizeSW2, id = 1))
fridgeSizeNM3<- as_tibble(melt(fridgeSizeNM2, id = 1))

fridgeTypeSW3<- as_tibble(melt(fridgeTypeSW2, id = 1))
fridgeTypeNM3<- as_tibble(melt(fridgeTypeNM2, id = 1))

incomeS3  <- as_tibble(melt(incomeS2, id = 1))
incomeT3  <- as_tibble(melt(incomeT2, id = 1))

membersS3  <- as_tibble(melt(membersS2, id = 1))
membersT3  <- as_tibble(melt(membersT2, id = 1))

climateS3 <- as_tibble(melt(climateS2, id=1))
climateT3 <- as_tibble(melt(climateT2, id=1))

########Rename cols pt1 (xVar/var)###########
colnames(fridgeSizeSW3)[colnames(fridgeSizeSW3) == "variable"] <- "FridgeSize"
colnames(fridgeSizeNM3)[colnames(fridgeSizeNM3) == "variable"] <- "FridgeSize"

colnames(fridgeTypeSW3)[colnames(fridgeTypeSW3) == "variable"] <- "FridgeType"
colnames(fridgeTypeNM3)[colnames(fridgeTypeNM3) == "variable"] <- "FridgeType"

colnames(incomeS3)[colnames(incomeS3) == "variable"]   <- "Income"
colnames(incomeT3)[colnames(incomeT3) == "variable"]   <- "Income"

colnames(membersS3)[colnames(membersS3) == "variable"]   <- "Members"
colnames(membersT3)[colnames(membersT3) == "variable"]   <- "Members"

colnames(climateS3)[colnames(climateS3) == "variable"]   <- "Climate"
colnames(climateT3)[colnames(climateT3) == "variable"]   <- "Climate"


########rename cols pt2 (yVar/value)###########
colnames(fridgeSizeSW3)[colnames(fridgeSizeSW3) == "value"] <- "TotalFrequency"
colnames(fridgeSizeNM3)[colnames(fridgeSizeNM3) == "value"] <- "TotalFrequency"

colnames(fridgeTypeSW3)[colnames(fridgeTypeSW3) == "value"] <- "TotalFrequency"
colnames(fridgeTypeNM3)[colnames(fridgeTypeNM3) == "value"] <- "TotalFrequency"

colnames(incomeS3)[colnames(incomeS3) == "value"]   <- "TotalFrequency"
colnames(incomeT3)[colnames(incomeT3) == "value"]   <- "TotalFrequency"

colnames(membersS3)[colnames(membersS3) == "value"]   <- "TotalFrequency"
colnames(membersT3)[colnames(membersT3) == "value"]   <- "TotalFrequency"

colnames(climateS3)[colnames(climateS3) == "value"]   <- "TotalFrequency"
colnames(climateT3)[colnames(climateT3) == "value"]   <- "TotalFrequency"
##########################################################################################################################################################################################################################################################################################################################################

```

###Purpose: 
We want to observe the trends between refrigerator types and refrigerator sizes across the different regions of South/West, North/Midwest and across differnt income brackets and household sizes. 

####Refrigerator Size vs South/West Region
As supported by the mean and the stacked bar plot, in the Total South, Total West and all the sub-regions, medium sized refrigerators (17.6 to 22.5 cubic feet) are the most common followed by the large sized refrigerators (22.6 to 29.5 cubic feet). An outlier in this result is that 0.5 percent of the population in the Total South does not use a refrigerator and that only about half of the regions use a very large (more than 29.5 cubic feet) refrigerator.
```{r echo=FALSE, warning=FALSE, message=FALSE}
#PLOT 1 
fridgeSizeSW3 %>%
  group_by(Size) %>%
  summarise_all(funs(mean(., na.rm=TRUE)))

ggplot(fridgeSizeSW3, aes(x = FridgeSize, y = TotalFrequency)) + 
  geom_col(aes(fill = Size)) + coord_flip() +
  ggtitle("Fridge Size vs South/West Region") + labs(x="Fridge Size",y="Frequency") 
```

####Refrigerator Size vs North/Midwest Region
Similar to the results we found above, in the Total North, Total Midwest and all the sub-regions, medium sized refrigerators (17.6 to 22.5 cubic feet) again are the most common followed by the large sized refrigerators (22.6 to 29.5 cubic feet). However, unlike the South and West region, there are no subregions here that use a half sized refrigerator or do not use a refrigerator at all.
```{r echo=FALSE, message=FALSE,warning=FALSE}
#PLOT 2
fridgeSizeNM3 %>%
  group_by(Size) %>%
  summarise_all(funs(mean(., na.rm=TRUE)))

ggplot(fridgeSizeNM3, aes(x = FridgeSize, y = TotalFrequency)) + 
  geom_col(aes(fill = Size)) + coord_flip() +
  ggtitle("Fridge Size vs North/Midwest Region") + labs(x="Fridge Size",y="Frequency") 
```

####Refrigerator Type vs South/West Region
As seen in the faceted bar graph below, the most popular types of refrigerators in the South/West respectively are the two doors, top freezeer and two doors, side to side. Concuring with the stacked bar graph that compared the subregions with fridge sizes, the subregions with the leading number of refrigerators are the South Atlantic, Pacific and West South Central. Again we note the outlier that 0.5 percent of the population in the Total South does not use a refrigerator.
```{r echo=FALSE, message=FALSE, warning=FALSE}
#PLOT 3
fridgeTypeSW3 %>%
  group_by(Type) %>%
  summarise_all(funs(mean(., na.rm=TRUE)))

ggplot(fridgeTypeSW3, aes(x = FridgeType, y = TotalFrequency)) +
   geom_bar(stat="identity") + facet_wrap(~ Type)  + coord_flip()  +
   ggtitle("Fridge Type vs South/West Region") + labs(x="Sub-Region",y="Frequency") 
```

####Refrigerator Type vs North/Midwest Region
Again, similar to the results we found in the South/West regions, the most popular types of refrigerators in the South/West respectively are the two doors, top freezeer and two doors, side to side. Concuring with the stacked bar graph that compared the subregions with fridge sizes, the subregions with the leading number of refrigerators are the East North Central and Middle Atlantic, respectively. Again, we note that zero percent of the population in the North/Midwest region uses compact fridge or does not use a fridge at all. 
```{r echo=FALSE, message=FALSE, warning=FALSE}
#PLOT 4
fridgeTypeNM3 %>%
  group_by(Type) %>%
  summarise_all(funs(mean(., na.rm=TRUE)))

ggplot(fridgeTypeNM3, aes(x = FridgeType, y = TotalFrequency)) +
   geom_bar(stat="identity") + facet_wrap(~ Type)  + coord_flip() +
   ggtitle("Fridge Type vs North/Midwest Region") + labs(x="Sub-Region",y="Frequency") 
```

###Regional Conclusion: North/Midwest vs South/West
In all the regions, the medium sized refrigerator was the most popular followed closely by the large sized refrigerator. And the most popular types of refrigerators respectively are the two doors, top freezer and two doors, side to side. Addiionally, overall very few subregions use a very large refrigerator. One main difference observed was the only in the South/West region 0.4 and 0.5 percent of the population respectively use a half sized/compact fridge or do not use a  refrigerator at all. In the North/Midwest regions, no one uses a half sized fridge, but everyone uses a fridge in general. 

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

####Income Levels vs Refrigerator Size
Concurring with the separate results we found above for the North/Midwest and South/West regions, in every income bracket the most popular size of refrigerator is the medium (17.6 to 22.5 cubic feet) followed by the large sized refrigerators (22.6 to 29.5 cubic feet). Two outliers to note is that 0.4 percent of the population with a income of \$20,000 or less does that use a refrigerator. 0.5 percent of the population with a income of \$20,000 or less uses a half sized compact fridge and 0,2 percent of the population with an income between \$20,000 and \$40,000 uses a half sized fridge. 
```{r echo=FALSE, message=FALSE, warning=FALSE}
#PLOT5
# ggplot(incomeS3, aes(x = Income, y = TotalFrequency)) +
#   geom_point()  + facet_wrap(~ Size) + coord_flip() +
#   ggtitle("Fridge Size vs Income") + labs(x="Fridge Size",y="Frequency")

#OR PLOT 5 
# incomeS3 %>%
#   group_by(Size) %>%
#   summarise_all(funs(mean(., na.rm=TRUE)))

ggplot(incomeS3, aes(x = Income, y = TotalFrequency)) + 
  geom_col(aes(fill = Size), position="dodge") + coord_flip() +
  ggtitle("Fridge Size vs Income") + labs(x="Fridge Size",y="Frequency")
```

####Income Levels vs Refrigerator Type
In the following income brackets, two doors, top freezer is the most popular type of fridge folowwed by the two doors, side to side: Under \$20,000, between \$20,000 and \$40,000, between \$40,000 and \$60,000, between \$60,000 and \$80,000. And inversly, in the following income brackets two doors, side to side is the most popular type of fridge followed by the two doors, top freezer: between \$80,000 and \$100,000, between \$100,000 and \$120,000, between \$120,000 and \$10,000, \$40,000 and above. The results are split half and half. Again, to note that 0.4 and 0.5 percent of  the population with a income of \$20,000 or less does not use a fridge or uses a compact sized fridge, respectively. 
```{r echo=FALSE, message=FALSE, warning=FALSE}
#PLOT 6
# ggplot(incomeT3, aes(x = Income, y = TotalFrequency)) + 
#   geom_point()  + facet_wrap(~ Type) + coord_flip() +
#   ggtitle("Fridge Type vs Income") + labs(x="Fridge Type",y="Frequency")

#OR PLOT6
# incomeT3 %>%
#   group_by(Type) %>%
#   summarise_all(funs(mean(., na.rm=TRUE)))

ggplot(incomeT3, aes(x = Income, y = TotalFrequency)) + 
  geom_col(aes(fill = Type), position="dodge") + coord_flip() + 
  ggtitle("Fridge Type vs Income") + labs(x="Fridge Type",y="Frequency")
```

###Income conclusion: 
Overall, population in the lower income brackets (From under \$20,000 to between \$60,000 to \$80,000). The most popular fridge size was medium followed by large and the most popular fride type was two doors, top freezer followed by two doors, side to side. The inverse was true for the population with a higher income bracket (from between \$80,000 = \$100,000 to \$140,000 and above). The most popular fridge size was large followed by medium and the most popular fride type was two doors, side to side followed by two doors, top freezer. And only in the population with income less that \$20,000 did 0.4 percent of the population not use a fridge at all. Since the income data was collected from all the regions, we can conclude that the results from the lower income brackets corresponds with the results found throughout all regions, with medium sized two doors, top freezer being the most popular kind of refrigerators.

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

####Refrigerator Size vs Household Members
In smaller households (with one, two and three members) medium sized fridges are the mots popular followed by large sized refrigerators. However, in larger households (four and firve or more members), large sized refrigerators are the most popular followed very closely by medium sized refrigerators. These results make perfect sense sincelarger famiy household require a larger refrigerator. Two noteworthy results are that only in a one member household do 0.4 and 0.5 perent of the population respectively use half sized fridges or do not use a refrigerator at all. 
```{r echo=FALSE, message=FALSE, warning=FALSE}
#PLOT 7 
# membersS3 %>%
#   group_by(Size) %>%
#   summarise_all(funs(mean(., na.rm=TRUE)))

ggplot(membersS3, aes(x = Size, y = TotalFrequency)) +
geom_col()  + facet_wrap(~ Members) + coord_flip() + geom_text(aes(label=TotalFrequency), vjust=1.5, hjust=-0.3) +
ggtitle("Fridge Size vs Household Members") + labs(x="Fridge Size",y="Frequency")
```

####Refrigerator Type vs Household Members
Again we see a differnce between smaller households (one, two or three members) and larger households (four or five or more members). In smaller households, two doors, top freezer is more popular followed by two doors, side to side. However, in a large four member household two doors, side to side is more popular followed by two doors, top freezer. And in the largest, five or more member household, both refrigerators are equally popular. Again, only in a one member household do 0.4 and 0.5 perent of the population respectively use compact sized fridges or do not use a refrigerator at all. 
```{r echo=FALSE, message=FALSE, warning=FALSE}
#PLOT 8 
# membersT3 %>%
#   group_by(Type) %>%
#   summarise_all(funs(mean(., na.rm=TRUE)))

ggplot(membersT3, aes(x = Type, y = TotalFrequency)) +
geom_col()  + facet_wrap(~ Members) + coord_flip() + geom_text(aes(label=TotalFrequency), vjust=1.5, hjust=-0.3) +
ggtitle("Fridge Type vs Household Members") + labs(x="Fridge Type",y="Frequency")
```

###Household members conclusion 
General conclusion about number of household members and refrigerator sizes and types are that smaller households (one, two or three members) use medium size and two doors, top freezer refrigerators. While larger households (four or five or more members) use large and two doors, side to side refrigerators. The only outlier is that only in the one member household 0.4 and 0.5 perent of the population respectively use compact sized fridges or do not use a refrigerator at all. 

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

##Overall Conclusion
From all the charts and analysis above we can make two overarching broad conclusions. 
In all four regions: North, Midwest, South and West, in the lower income bracket and in smaller households, the most popular size refrigerator is medium and the most popular type of refrigerator is two doors, top freezer. 

Secondly, (the second more popular) in all four regions, in the higher income brackets and in larger households, the most popular size of refrigerator is large and the most popular type is two door, side to side. 

This makes sense that larger families with higher income would prefer a larger refrigerator while a smaller family with a lower income would prefer a medium sized refrigerator. This trend would be observed throughout all four regions. 

A common outlier found in all results is that in populations that have an income of less that \$20,000, in a one person household (in the South and West Regions) there is about 0.5 percent of the population that does not use a refrigerator and 0.5 percent of the population that uses a half sized/compact refrigerator. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
#PLOT9
ggplot(climateS3, aes(x = Size, y = TotalFrequency)) + 
  geom_col(aes(fill = Climate), position="dodge") + coord_flip() +
  ggtitle("Fridge Size vs Climate") + labs(x="Fridge Size",y="Frequency")

#PLOT10
ggplot(climateT3, aes(x = Type, y = TotalFrequency)) + 
  geom_col(aes(fill = Climate), position="dodge") + coord_flip() + 
  ggtitle("Fridge Type vs Climate") + labs(x="Fridge Type",y="Frequency")
```